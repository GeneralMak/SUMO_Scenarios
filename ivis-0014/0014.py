# 配置导入库目录
import traci
import sys
import time
import os

if __name__ == '__main__':
    veh_0 = [(0.0, -1.6), (0.5, -1.6), (1.0, -1.6), (1.5, -1.6), (2.0, -1.6), (2.5, -1.6), (3.0, -1.6), (3.5, -1.6),
             (4.0, -1.6), (4.5, -1.6), (5.0, -1.6), (5.5, -1.6), (6.0, -1.6), (6.5, -1.6), (7.0, -1.6), (7.5, -1.6),
             (8.0, -1.6), (8.5, -1.6), (9.0, -1.6), (9.5, -1.6), (10.0, -1.6), (10.5, -1.6), (11.0, -1.6), (11.5, -1.6),
             (12.0, -1.6), (12.5, -1.6), (13.0, -1.6), (13.5, -1.6), (14.0, -1.6), (14.5, -1.6), (15.0, -1.6), (15.5, -1.6),
             (16.0, -1.6), (16.5, -1.6), (17.0, -1.6), (17.5, -1.6), (18.0, -1.6), (18.5, -1.6), (19.0, -1.6), (19.5, -1.6),
             (20.0, -1.6), (20.5, -1.6), (21.0, -1.6), (21.5, -1.6), (22.0, -1.6), (22.5, -1.6), (23.0, -1.6), (23.5, -1.6),
             (24.0, -1.6), (24.5, -1.6), (25.0, -1.6), (25.5, -1.6), (26.0, -1.6), (26.5, -1.6), (27.0, -1.6), (27.5, -1.6),
             (28.0, -1.6), (28.5, -1.6), (29.0, -1.6), (29.5, -1.6), (30.0, -1.6), (30.5, -1.6), (31.0, -1.6), (31.5, -1.6),
             (32.0, -1.6), (32.5, -1.6), (33.0, -1.6), (33.5, -1.6), (34.0, -1.6), (34.5, -1.6), (35.0, -1.6), (35.5, -1.6),
             (36.0, -1.6), (36.5, -1.6), (37.0, -1.6), (37.5, -1.6), (38.0, -1.6), (38.5, -1.6), (39.0, -1.6), (39.5, -1.6),
             (40.0, -1.6), (40.5, -1.6), (41.0, -1.6), (41.5, -1.6), (42.0, -1.6), (42.5, -1.6), (43.0, -1.6), (43.5, -1.6),
             (44.0, -1.6), (44.5, -1.6), (45.0, -1.6), (45.5, -1.6), (46.0, -1.6), (46.5, -1.6), (47.0, -1.6), (47.5, -1.6),
             (48.0, -1.6), (48.5, -1.6), (49.0, -1.6), (49.5, -1.6), (50.0, -1.6)]

    veh_1 = [(100.0, -1.6), (99.5, -1.6), (99.0, -1.6), (98.5, -1.6), (98.0, -1.6), (97.5, -1.6), (97.0, -1.6), (96.5, -1.6),
             (96.0, -1.6), (95.5, -1.6), (95.0, -1.6), (94.5, -1.6), (94.0, -1.6), (93.5, -1.6), (93.0, -1.6), (92.5, -1.6),
             (92.0, -1.6), (91.5, -1.6), (91.0, -1.6), (90.5, -1.6), (90.0, -1.6), (89.5, -1.6), (89.0, -1.6), (88.5, -1.6),
             (88.0, -1.6), (87.5, -1.6), (87.0, -1.6), (86.5, -1.6), (86.0, -1.6), (85.5, -1.6), (85.0, -1.6), (84.5, -1.6),
             (84.0, -1.6), (83.5, -1.6), (83.0, -1.6), (82.5, -1.6), (82.0, -1.6), (81.5, -1.6), (81.0, -1.6), (80.5, -1.6),
             (80.0, -1.6), (79.5, -1.6), (79.0, -1.6), (78.5, -1.6), (78.0, -1.6), (77.5, -1.6), (77.0, -1.6), (76.5, -1.6),
             (76.0, -1.6), (75.5, -1.6), (75.0, -1.6), (74.5, -1.6), (74.0, -1.6), (73.5, -1.6), (73.0, -1.6), (72.5, -1.6),
             (72.0, -1.6), (71.5, -1.6), (71.0, -1.6), (70.5, -1.6), (70.0, -1.6), (69.5, -1.6), (69.0, -1.6), (68.5, -1.6),
             (68.0, -1.6), (67.5, -1.6), (67.0, -1.6), (66.5, -1.6), (66.0, -1.6), (65.5, -1.6), (65.0, -1.6), (64.5, -1.6),
             (64.0, -1.6), (63.5, -1.6), (63.0, -1.6), (62.5, -1.6), (62.0, -1.6), (61.5, -1.6), (61.0, -1.6), (60.5, -1.6),
             (60.0, -1.6), (59.5, -1.6), (59.0, -1.6), (58.5, -1.6), (58.0, -1.6), (57.5, -1.6), (57.0, -1.6), (56.5, -1.6),
             (56.0, -1.6), (55.5, -1.6), (55.0, -1.6), (54.5, -1.6), (54.0, -1.6), (53.5, -1.6), (53.0, -1.6), (52.5, -1.6),
             (52.0, -1.6), (51.5, -1.6), (51.0, -1.6), (50.5, -1.6), (50.0, -1.6)]
    # 配置调用目录
    try:
        SUMO_HOME = os.environ.get('SUMO_HOME')
    except:
        print('配置SUMO环境')
    else:
        sys.path.append(SUMO_HOME+'/tools/')
        sumoBinary = SUMO_HOME+"/bin/sumo-gui"
        sumoCmd = [sumoBinary, "-c", r'0014.sumocfg']

        # 导入traci模块
        traci.start(sumoCmd)
        collisionVehList = set()

        # collisionTag = False
        step = 0
        while traci.simulation.getMinExpectedNumber() > 0:

            traci.vehicle.moveToXY('0', 'WE', 0, veh_0[step][0], veh_0[step][1])
            traci.vehicle.moveToXY('1', 'WE', 0, veh_1[step][0], veh_1[step][1])
            traci.simulationStep()
            if traci.simulation.getCollidingVehiclesNumber() > 0:
                collisionVeh = set(traci.simulation.getCollidingVehiclesIDList())
                collisionVehList.update(collisionVeh)
                for veh in collisionVehList:
                    traci.vehicle.setColor(veh, (255, 0, 0))
                time.sleep(5)
                traci.close()
            print('事故车辆：', collisionVehList)

            step += 1